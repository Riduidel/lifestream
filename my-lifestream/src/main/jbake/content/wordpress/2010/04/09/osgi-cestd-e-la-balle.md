type: post
status: published
title: OSGi, c'estd e la balle 
tags: ioc, java, osgi
date: Fri Apr 09 15:31:06 CEST 2010
~~~~~~
# OSGi, c'estd e la balle 

**disclaimer** : Pour les non javaistes qui me lisent, attention, ce post est exceptionnellement techno-technique  


Depuis deux semaines, je d??couvre un nouveau pan des ??normes possibilit??s de l'informatique "d'entreprise" en Java : OSGi.  
Bon, comme je n'ai pas l'intention de vous faire un post didactique (le web en est plein), je vais juste commencer par une petite rafale de liens sur le sujet.
* l'obligatoire page [wikipeda](http://fr.wikipedia.org/wiki/OSGi)
* [un cours](http://membres-liglab.imag.fr/donsez/cours/exemplesosgi/) sur le sujet
* un article chez [d??veloppez.com](http://t-templier.developpez.com/tutoriel/java/osgi/osgi1/)
* Et peut-??tre plus int??ressant, [un article](http://www.tomsquest.com/blog/osgi-oui-mais-non/) un peu critique.Bon, si vous avez lu ces articles, vous aurez compris qu'OSGi est un cadriciel (ou plut??t framework) permettant de cr??er facilement des applications ?? base de composant. La diff??rence avec, je sais pas, moi, Spring ou JEE, c'est qu'?? cause d'un pass?? diff??rent, OSGi ne met pas la m??me chose derri??re le terme de composant. Ici, un composant peut ??tre arr??t??, red??marr??, sans que la plateforme s'arr??te. D'ailleurs, dans le cas o?? un composant s'arr??te, ses d??pendances seront notifi??es et pourront se d??sactiver automatiquement. D??pendances ?Oui, d??pendances. le secret d'une architecture orient??e composant, c'est qu'un composant A peut avoir besoin d'un composant identif?? B (ou plut??t, dans le cas d'OSGi, une version d'un composant identifi??). Bon, d'habitude, quand on met c??te ?? c??te des composants, des d??pendances, des version, on pense maven. Et ??a tombe bien, parce que gr??ce au travail d'??quipes du monde de l'open-source, il existe des moyens de bien faire travailler ensemble maven et OSGi :
* [maven-bundle-plugin](http://felix.apache.org/site/apache-felix-maven-bundle-plugin-bnd.html) permet de prendre un projet maven et de le packager en tant que bundle osgi. Les d??pendances seront correctement d??clar??es dans le MANIFEST.MF, mais les Export-Package et Private-Package devront encore ??tre d??finis ?? la main, mais dans le pom.xml, ce qui est raisonnablement cens??. Bon, c'est pratique, mais il faut encore avoir ?? c??t?? un conteneur OSGi (qui permet de lancer le paquet de bundles) pour tester l'appli
* [pax](http://www.ops4j.org/projects/pax/construct/maven-pax-plugin/) permet d'embarquer tout ??a dans un projet maven d'une mani??re assez muscl??e, mais efficace. Celui-l?? est largement plus costaud que le pr??cedent, mais coup de bol, son utilsiation est largement document??e dans le [handbook maven de Sonatype](http://www.sonatype.com/books/mcookbook/reference/osgi.html).
* Et pour finir, si vous voulez approcher de l'IoC (ce que OSGi ne permet pas vraiment ?? la base), [iPOJO](http://felix.apache.org/site/apache-felix-ipojo.html) va vous fournir un paquet d'outils pour d??velopper vos bundles tranquillement (en particulier une t??che maven d'automatisation). Bon, je n'ai aps encore test?? l'int??gration d'iPOJO ?? pax, mais ?? mon avis, tant que les d??pendances sont pr??sentes (donc le bundle iPOJO, et deux ou trois autres trucs), tout va bien !Bon, avec ??a, vous avez un rapide tour d'horizon de ma caisse ?? outils OSGi, dont le but est de d??velopper des applications rapidement, confortablement, et sans ??tre trop emb??t?? par la cuisine interne. Et je suis s??r qu'en vrai, c'est pas ??a qui vous int??resse. Ce qui vous int??resse (si vous ??tes arriv??s jusque l??) c'est ce que j'en pense.

Pendant longtemps, j'ai un avis d??favorable sur OSGi. je savais qu'Eclipse l'utilisait, mais je savais aussi que c'??tait le seul cas connu d'utilisation "grand public" d'OSGi. Ces derniers temps, les choses ont chang??. Les serveurs d'applications utilisent maintenant presque tous OSGi comme socle technique. Une biblioth??que comme [Sling](http://sling.apache.org/site/index.html) utilise OSGi car ??a permet une tr??s forte modularit?? ?? un co??t assez faible, avec en bonus des fonctionnalit??s super int??ressantes. Et puis finallement, quand on regarde le [getting started](http://felix.apache.org/site/apache-felix-osgi-tutorial.html) de Felix, et encore plus quand on le suit pas ?? pas, OSGi n'est pas plus compliqu?? que, je sais moi, [Guice](http://code.google.com/p/google-guice/). En fait, ?? l'heure actuelle (justement pour faire le parall??le avec Guice) la seule chose qui ne soit pas compl??tement parfaite, c'est le c??t?? IoC. M??me si on utilise les tr??s pratiques [annotations iPOJO](http://felix.apache.org/site/ipojo-reference-card.html), on doit encore d??clarer ses instances s??par??ment (ce qui vide ?? mon avis l'IoC de son concept). Heureusement, les choses ??voluent rapidement dans le monde OSGi (?? mon avis gr??ce ?? l'adoption massive par les serveurs d'application JEE), et l'??quipe Felix me promet que la prochaine version permettra de se passer totallement des fichiers de d??claration XML.

C'est bien simple, je n'envisage maintenant plus mes projets de la m??me mani??re (c'est-??-dire sans OSGi), et je crois m??me que je vais migrer certains de Guice ?? OSGi si j'arrive ?? comprendre comment faire pour livrer un JAR ex??cutable avec pax (le top absolu serait de r??ussir ?? lancer une application OSGi via Java Web Start, cela dit, j'ai [confiance](http://www.toedter.com/blog/?p=45))