type: post
status: published
title: La bataille du build ? Maven l'a gagn??e !
tags: build, int??gration, java, maven
date: Wed Nov 24 14:14:00 CET 2010
~~~~~~
# La bataille du build ? Maven l'a gagn??e !

C'est vrai, quoi, en ces temps de guéguerre stratégique qui nous passe, en fait, bien au-dessus de la tête (je ne vois par exemple pas en quoi la guetre Oracle/Apache a la moindre chance de se répercuter d'une façon concrète, ou visible, si vous préférez, sur mon environnement de travail), il ne faut pas oublier une autre guerre, qui court depuis des années dans le monde Java, celle du build.En effet, pendant longtemps, l'outil de build "standard" s'appelait [Ant](http://ant.apache.org). C'est d'ailleurs avec lui que j'ai fait mes armes Java avant l'an 2000, je crois (hélas, à cause de mon utilisation un peu tordue des frames et du Javascript, l'internet Wayback machine a perdu mon explciation de 2001 sur l'intérêt d'Ant. En même temps, il était oubliable). Donc, pendant longtemps, Ant a régné comme seul maître (ce qui lui a permis de s'intégrer aux IDE d'une manière "raisonnable" - j'ai des souvenirs assez terrifiants de la mauvaise intégration à JBuilder, par exemple). Et puis [maven](http://maven.apache.org) est apparu. Maven a, malgré tout ce qu'on lui repproche, apporté une tonne de choses au build java :
* Un côté convention over configuration : même si c'est assez loin de la légèreté proposée par [Ruby on Rails](http://en.wikibooks.org/wiki/Ruby_on_Rails/Getting_Started/Convention_Over_Configuration), on a quand même [le même objectif](http://www.sonatype.com/books/mvnref-book/reference/installation-sect-conventionConfiguration.html) : faire en sorte qu'un projet qui suive la *maven way* soit très simple à définir, et ne compliquer les choses que dans les cas "exotiques".
* Une organisation standard des projets : parce qu'avant, c'était quand même un peu fait n'importe comment, alors qu'après, on a pu commencer à imaginer que chaque projet range ses sources dans <span style="font-family:courier new, monospace;">src/main/java</span>, ses tests dans <span style="font-family:courier new, monospace;">src/test/java</span>, et [ainsi de suite](http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html) ...
* Un cycle de vie standard : combien de fois, avec Ant, ne me suis-je pas posé la question du comment faire pour que ce truc ait lieu avant ou après tel autre (oui, je sais, merci, la réponse est théoriquement assez simple avec les depends, mais quand même, au bout d'un moment, c'est assez pénible). Avec maven, c'est conceptuellement plus facile : on identifie la phase du [cycle de vie](http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html) pendant laquelle on veut faire un truc, et "pouf" (je mets pouf alors que jee sais que c'est bien plus compliquée que ça. cela dit, ce qui m'intéresse ici, ce n'est pas l'implémentation, mais l'idée), on le fait là.
* Une gestion des dépendances idéale : et là, je ne rigole pas (notez bien que pour les points précédents, je ne rigolais pas non plus, mais là, on est vraiment dans le secret de maven). Avant, la seule façon de gérer ses dépendances, c'était de mettre un paquet de jar dans un dossier libs, et de mettre ce dossier libs dans le gestionnaire de source. Pas idéal, parce qu'évidement, ce ne sont pas des sources, mais des jars. Pas idéal non plus, parce que si par exemple je veux utiliser du code XPath avec [JDOM](http://www.jdom.org/), je dois penser à télécharger la bonne version de [Jaxen](http://jaxen.codehaus.org/). Alors que théoriquement, avec maven, il l'aurait téléchargé tout de suite à la bonne version (je dis théoriquement, parce qu'à mon avis, jaxen doit être une dépendance optionnelle de JDOM). Bref, avec maven, on remplace les ajrs salement flanqués dans le gestionnaire de source par des dépendances déclaratives dans un fichier de configuration qui, lui, est dans le gestionnaire de source. Et, cerise sur le gateau, maven télécharge les dépendances tout seul, éventuellement en passant par un proxy, à la demande.Bon, évidement, maven n'est pas parfait. Pour moi, son plus gros défaut est d'être apparu pendant la mode du XML, ce qui fait que son POM apparaît maintenant comme daté. C'est d'ailleurs ça qui a précipité l'apparition de nouveaux outils qui reprennent peu ou prou tous les éléments de maven en supprimant le côté XML (comme par exemple [Gradle](http://gradle.org/)). Mais personnellement, j'ai l'impression qu'en faisant ça, les créateurs de ces outils ont jeté le bébé avec l'eau du bain. En effet, dans les reproches tradionnellement faits à maven, il y a évidement la lourdeur du XML. Or, avec maven 3 et des initiatives comme [Polyglot Maven](http://polyglot.sonatype.org/), ce XML va se trouver remplacé par ... du Groovy, du Scala, du Clojure, du Java, .... Et à mon avis, d'ici quelques années, maven va reprendre la place des outils qui essayent de s'appuyer sur ses réussites, sans vraiment remplacer tous ses plugins qui lui donnent sa puissance.